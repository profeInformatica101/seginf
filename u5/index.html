<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Criptograf√≠a ‚Äî OpenSSL & GPG</title>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Syne:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0a0e1a;
      --surface: #111827;
      --surface2: #1a2236;
      --border: #1e3a5f;
      --accent-sym: #00e5ff;
      --accent-hash: #b388ff;
      --accent-asym: #69ff47;
      --text: #e2e8f0;
      --text-muted: #64748b;
      --warn: #ffb74d;
      --danger: #ef5350;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Syne', sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(rgba(0,229,255,0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0,229,255,0.03) 1px, transparent 1px);
      background-size: 40px 40px;
      pointer-events: none;
      z-index: 0;
    }

    .wrapper {
      position: relative;
      z-index: 1;
      max-width: 1100px;
      margin: 0 auto;
      padding: 60px 24px 80px;
    }

    header {
      text-align: center;
      margin-bottom: 64px;
    }

    header .eyebrow {
      font-family: 'JetBrains Mono', monospace;
      font-size: 12px;
      letter-spacing: 4px;
      color: var(--accent-sym);
      text-transform: uppercase;
      margin-bottom: 16px;
      opacity: 0.8;
    }

    header h1 {
      font-size: clamp(2rem, 5vw, 3.5rem);
      font-weight: 800;
      line-height: 1.1;
      background: linear-gradient(135deg, #00e5ff, #b388ff, #69ff47);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    header p {
      margin-top: 16px;
      color: var(--text-muted);
      font-size: 1rem;
      font-weight: 400;
    }

    .tabs {
      display: flex;
      gap: 4px;
      background: var(--surface);
      border-radius: 14px;
      padding: 6px;
      margin-bottom: 40px;
      border: 1px solid var(--border);
    }

    .tab-btn {
      flex: 1;
      padding: 12px 8px;
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-family: 'Syne', sans-serif;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      border-radius: 10px;
      transition: all 0.25s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .tab-btn .dot {
      width: 8px; height: 8px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .tab-btn[data-tab="simetrica"] .dot { background: var(--accent-sym); }
    .tab-btn[data-tab="hash"] .dot { background: var(--accent-hash); }
    .tab-btn[data-tab="asimetrica"] .dot { background: var(--accent-asym); }

    .tab-btn.active { color: var(--text); }
    .tab-btn[data-tab="simetrica"].active { background: rgba(0,229,255,0.12); }
    .tab-btn[data-tab="hash"].active { background: rgba(179,136,255,0.12); }
    .tab-btn[data-tab="asimetrica"].active { background: rgba(105,255,71,0.12); }

    .section { display: none; }
    .section.active { display: block; animation: fadeUp 0.35s ease; }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(16px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 32px;
    }

    .section-icon {
      font-size: 2rem;
      width: 56px; height: 56px;
      display: flex; align-items: center; justify-content: center;
      border-radius: 14px;
      flex-shrink: 0;
    }

    .simetrica .section-icon { background: rgba(0,229,255,0.1); border: 1px solid rgba(0,229,255,0.2); }
    .hash .section-icon { background: rgba(179,136,255,0.1); border: 1px solid rgba(179,136,255,0.2); }
    .asimetrica .section-icon { background: rgba(105,255,71,0.1); border: 1px solid rgba(105,255,71,0.2); }

    .section-title h2 {
      font-size: 1.5rem;
      font-weight: 800;
    }

    .simetrica .section-title h2 { color: var(--accent-sym); }
    .hash .section-title h2 { color: var(--accent-hash); }
    .asimetrica .section-title h2 { color: var(--accent-asym); }

    .section-title p {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .tool-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    @media (max-width: 700px) {
      .tool-grid { grid-template-columns: 1fr; }
      .tabs { flex-direction: column; }
    }

    .tool-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      overflow: hidden;
      transition: border-color 0.2s, transform 0.2s;
    }

    .tool-card:hover { transform: translateY(-2px); }

    .simetrica .tool-card:hover { border-color: rgba(0,229,255,0.4); }
    .hash .tool-card:hover { border-color: rgba(179,136,255,0.4); }
    .asimetrica .tool-card:hover { border-color: rgba(105,255,71,0.4); }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 20px 12px;
      border-bottom: 1px solid var(--border);
    }

    .card-header .tool-name {
      font-size: 0.7rem;
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    .simetrica .card-header .tool-name { color: var(--accent-sym); }
    .hash .card-header .tool-name { color: var(--accent-hash); }
    .asimetrica .card-header .tool-name { color: var(--accent-asym); }

    .card-header h3 {
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text);
      margin-top: 2px;
    }

    .badge {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.65rem;
      padding: 3px 8px;
      border-radius: 6px;
      font-weight: 700;
    }

    .badge-rec {
      background: rgba(105,255,71,0.1);
      color: var(--accent-asym);
      border: 1px solid rgba(105,255,71,0.3);
    }

    .badge-warn {
      background: rgba(255,183,77,0.1);
      color: var(--warn);
      border: 1px solid rgba(255,183,77,0.3);
    }

    .badge-dep {
      background: rgba(239,83,80,0.1);
      color: var(--danger);
      border: 1px solid rgba(239,83,80,0.3);
    }

    .card-body { padding: 16px 20px 20px; }

    .cmd-block { margin-top: 10px; }

    .cmd-block .label {
      font-size: 0.7rem;
      color: var(--text-muted);
      font-family: 'JetBrains Mono', monospace;
      margin-bottom: 6px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .cmd-wrap { position: relative; }

    pre {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px 48px 12px 14px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: #a5f3fc;
      overflow-x: auto;
      white-space: pre-wrap;
      word-break: break-all;
      line-height: 1.6;
    }

    .copy-btn {
      position: absolute;
      top: 8px; right: 8px;
      background: var(--border);
      border: none;
      color: var(--text-muted);
      border-radius: 6px;
      padding: 4px 8px;
      font-size: 0.65rem;
      cursor: pointer;
      font-family: 'JetBrains Mono', monospace;
      transition: all 0.2s;
    }

    .copy-btn:hover { background: #2a4a7f; color: var(--text); }
    .copy-btn.copied { color: var(--accent-asym); }

    .note {
      margin-top: 10px;
      padding: 10px 14px;
      border-radius: 8px;
      font-size: 0.78rem;
      line-height: 1.5;
      display: flex;
      gap: 8px;
      align-items: flex-start;
    }

    .note-warn {
      background: rgba(255,183,77,0.07);
      border: 1px solid rgba(255,183,77,0.2);
      color: var(--warn);
    }

    .note-danger {
      background: rgba(239,83,80,0.07);
      border: 1px solid rgba(239,83,80,0.2);
      color: #ff8a80;
    }

    .note-info {
      background: rgba(100,116,139,0.1);
      border: 1px solid rgba(100,116,139,0.2);
      color: var(--text-muted);
    }

    .compare-section { margin-top: 60px; }

    .compare-title {
      font-size: 1.2rem;
      font-weight: 800;
      color: var(--text);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .compare-title::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--border);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.82rem;
    }

    th {
      background: var(--surface2);
      padding: 12px 16px;
      text-align: left;
      font-weight: 700;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.72rem;
      letter-spacing: 1px;
      text-transform: uppercase;
      border-bottom: 2px solid var(--border);
    }

    th:nth-child(2) { color: var(--accent-sym); }
    th:nth-child(3) { color: var(--accent-hash); }

    td {
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
      color: var(--text-muted);
      vertical-align: top;
    }

    td:first-child {
      color: var(--text);
      font-weight: 600;
      white-space: nowrap;
    }

    tr:hover td { background: rgba(255,255,255,0.02); }

    .tick { color: var(--accent-asym); }
    .cross { color: var(--danger); }
  </style>
</head>

<body>
  <div class="wrapper">

    <header>
      <p class="eyebrow">// Referencia de comandos</p>
      <h1>Criptograf√≠a<br>OpenSSL &amp; GPG</h1>
      <p>Comandos actualizados ‚Äî 2025</p>
    </header>

    <div class="tabs">
      <button class="tab-btn active" data-tab="simetrica">
        <span class="dot"></span> Criptograf√≠a Sim√©trica
      </button>
      <button class="tab-btn" data-tab="hash">
        <span class="dot"></span> Funciones Hash
      </button>
      <button class="tab-btn" data-tab="asimetrica">
        <span class="dot"></span> Criptograf√≠a Asim√©trica
      </button>
    </div>

    <!-- ============================= -->
    <!-- SECCI√ìN 1: SIM√âTRICA -->
    <!-- ============================= -->
    <div class="section simetrica active" id="simetrica">
      <div class="section-header">
        <div class="section-icon">üîê</div>
        <div class="section-title">
          <h2>Criptograf√≠a Sim√©trica</h2>
          <p>Misma clave para cifrar y descifrar ¬∑ AEAD recomendado (AES-GCM / ChaCha20-Poly1305)</p>
        </div>
      </div>

      <div class="tool-grid">

        <!-- OpenSSL Cifrado -->
        <div class="tool-card">
          <div class="card-header">
            <div>
              <div class="tool-name">OpenSSL</div>
              <h3>Cifrado sim√©trico</h3>
            </div>
            <span class="badge badge-rec">‚úì Recomendado</span>
          </div>
          <div class="card-body">
            <div class="cmd-block">
              <div class="label">// Cifrar ‚Äî AES-256-GCM (recomendado)</div>
              <div class="cmd-wrap">
                <pre id="c1">openssl enc -aes-256-gcm \
  -pbkdf2 -iter 600000 -salt \
  -in archivo.txt \
  -out archivo.enc</pre>
                <button class="copy-btn" onclick="copyCmd('c1', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Descifrar</div>
              <div class="cmd-wrap">
                <pre id="c2">openssl enc -d -aes-256-gcm \
  -pbkdf2 -iter 600000 \
  -in archivo.enc \
  -out archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('c2', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Alternativa ‚Äî ChaCha20-Poly1305 (r√°pido en m√≥viles/CPUs sin AES-NI)</div>
              <div class="cmd-wrap">
                <pre id="c6">openssl enc -chacha20-poly1305 \
  -pbkdf2 -iter 600000 -salt \
  -in archivo.txt \
  -out archivo.enc</pre>
                <button class="copy-btn" onclick="copyCmd('c6', this)">copiar</button>
              </div>
            </div>

            <div class="note note-info">
              üí° AES-256-GCM y ChaCha20-Poly1305 son AEAD: incluyen autenticaci√≥n y detectan manipulaciones.
            </div>
            <div class="note note-warn">
              ‚ö†Ô∏è Evita poner la contrase√±a con <code style="background:none;color:inherit">-pass pass:xxx</code> (queda en historial). Mejor lectura interactiva o <code style="background:none;color:inherit">-pass file:clave.txt</code>.
            </div>
            <div class="note note-info">
              ‚è±Ô∏è Ajusta <code style="background:none;color:inherit">-iter</code> para que la derivaci√≥n tarde ~200‚Äì500 ms en tu equipo (equilibrio entre seguridad y usabilidad).
            </div>
          </div>
        </div>

        <!-- GPG Cifrado -->
        <div class="tool-card">
          <div class="card-header">
            <div>
              <div class="tool-name">GPG</div>
              <h3>Cifrado sim√©trico</h3>
            </div>
            <span class="badge badge-rec">‚úì Recomendado</span>
          </div>
          <div class="card-body">
            <div class="cmd-block">
              <div class="label">// Cifrar con AES-256</div>
              <div class="cmd-wrap">
                <pre id="c3">gpg -c --cipher-algo AES256 \
  --s2k-digest-algo SHA512 \
  -o archivo.gpg archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('c3', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Descifrar</div>
              <div class="cmd-wrap">
                <pre id="c4">gpg -d archivo.gpg &gt; archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('c4', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Ver algoritmos disponibles</div>
              <div class="cmd-wrap">
                <pre id="c5">gpg --version</pre>
                <button class="copy-btn" onclick="copyCmd('c5', this)">copiar</button>
              </div>
            </div>

            <div class="note note-info">
              üí° GPG pide la passphrase de forma interactiva por defecto ‚Äî evita exponerla en argumentos/historial.
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- ============================= -->
    <!-- SECCI√ìN 2: HASH -->
    <!-- ============================= -->
    <div class="section hash" id="hash">
      <div class="section-header">
        <div class="section-icon">üîç</div>
        <div class="section-title">
          <h2>Funciones Hash</h2>
          <p>Integridad ¬∑ SHA-256 m√≠nimo, SHA-3 recomendado; BLAKE3 muy r√°pido (no universal)</p>
        </div>
      </div>

      <div class="tool-grid">

        <!-- OpenSSL Hashes -->
        <div class="tool-card">
          <div class="card-header">
            <div>
              <div class="tool-name">OpenSSL</div>
              <h3>Hashes actuales</h3>
            </div>
            <span class="badge badge-rec">‚úì Recomendado</span>
          </div>
          <div class="card-body">
            <div class="cmd-block">
              <div class="label">// SHA-256</div>
              <div class="cmd-wrap">
                <pre id="h1">openssl dgst -sha256 archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('h1', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// SHA-512</div>
              <div class="cmd-wrap">
                <pre id="h2">openssl dgst -sha512 archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('h2', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// SHA3-256 (recomendado)</div>
              <div class="cmd-wrap">
                <pre id="h3">openssl dgst -sha3-256 archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('h3', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Guardar hash en archivo (formato compatible con -c)</div>
              <div class="cmd-wrap">
                <pre id="h4">sha256sum archivo.txt &gt; archivo.sha256</pre>
                <button class="copy-btn" onclick="copyCmd('h4', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Listar algoritmos disponibles</div>
              <div class="cmd-wrap">
                <pre id="h5">openssl list -digest-algorithms</pre>
                <button class="copy-btn" onclick="copyCmd('h5', this)">copiar</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Sistema + BLAKE3 -->
        <div class="tool-card">
          <div class="card-header">
            <div>
              <div class="tool-name">Sistema / BLAKE3</div>
              <h3>Hashes modernos</h3>
            </div>
            <span class="badge badge-rec">‚úì Recomendado</span>
          </div>
          <div class="card-body">
            <div class="cmd-block">
              <div class="label">// SHA-256 (sistema)</div>
              <div class="cmd-wrap">
                <pre id="h6">sha256sum archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('h6', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// SHA-512 (sistema)</div>
              <div class="cmd-wrap">
                <pre id="h7">sha512sum archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('h7', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// BLAKE3 ‚Äî r√°pido (requiere instalar)</div>
              <div class="cmd-wrap">
                <pre id="h8"># Instalar (Rust): cargo install b3sum
b3sum archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('h8', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Verificar integridad</div>
              <div class="cmd-wrap">
                <pre id="h9">sha256sum -c archivo.sha256</pre>
                <button class="copy-btn" onclick="copyCmd('h9', this)">copiar</button>
              </div>
            </div>

            <div class="note note-info">
              üí° Para integridad ‚Äúreal‚Äù ante atacantes, usa firma digital o AEAD. Un hash suelto solo detecta cambios si el hash se distribuye por un canal confiable.
            </div>
          </div>
        </div>

        <!-- Obsoletos -->
        <div class="tool-card" style="grid-column: 1 / -1;">
          <div class="card-header">
            <div>
              <div class="tool-name">Obsoletos ‚Äî NO usar en producci√≥n</div>
              <h3>MD5 ¬∑ SHA-1</h3>
            </div>
            <span class="badge badge-dep">‚úó Deprecado</span>
          </div>
          <div class="card-body">
            <div class="tool-grid" style="margin-top:0;">
              <div>
                <div class="cmd-block">
                  <div class="label">// MD5 (solo legacy)</div>
                  <div class="cmd-wrap">
                    <pre id="h10">openssl dgst -md5 archivo.txt
# o
md5sum archivo.txt</pre>
                    <button class="copy-btn" onclick="copyCmd('h10', this)">copiar</button>
                  </div>
                </div>
              </div>
              <div>
                <div class="cmd-block">
                  <div class="label">// SHA-1 (solo legacy)</div>
                  <div class="cmd-wrap">
                    <pre id="h11">openssl dgst -sha1 archivo.txt
# o
sha1sum archivo.txt</pre>
                    <button class="copy-btn" onclick="copyCmd('h11', this)">copiar</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="note note-danger" style="margin-top:12px;">
              üö® MD5 y SHA-1 tienen colisiones conocidas: √∫salos solo por compatibilidad con sistemas antiguos.
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- ============================= -->
    <!-- SECCI√ìN 3: ASIM√âTRICA -->
    <!-- ============================= -->
    <div class="section asimetrica" id="asimetrica">
      <div class="section-header">
        <div class="section-icon">üóùÔ∏è</div>
        <div class="section-title">
          <h2>Criptograf√≠a Asim√©trica</h2>
          <p>Firma (Ed25519) + Certificados (X.509) ¬∑ Para ‚Äúcifrar‚Äù se usa h√≠brido (intercambio + sim√©trica)</p>
        </div>
      </div>

      <div class="tool-grid">

        <!-- OpenSSL Claves -->
        <div class="tool-card">
          <div class="card-header">
            <div>
              <div class="tool-name">OpenSSL ‚Äî Claves</div>
              <h3>Ed25519 / ECDSA / RSA</h3>
            </div>
            <span class="badge badge-rec">‚úì Recomendado</span>
          </div>
          <div class="card-body">
            <div class="cmd-block">
              <div class="label">// Generar clave privada Ed25519 (firma)</div>
              <div class="cmd-wrap">
                <pre id="a1">openssl genpkey \
  -algorithm Ed25519 \
  -out privada_ed25519.pem</pre>
                <button class="copy-btn" onclick="copyCmd('a1', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Extraer clave p√∫blica</div>
              <div class="cmd-wrap">
                <pre id="a2">openssl pkey -in privada_ed25519.pem \
  -pubout -out publica_ed25519.pem</pre>
                <button class="copy-btn" onclick="copyCmd('a2', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Generar clave ECDSA (P-384) ‚Äî firma</div>
              <div class="cmd-wrap">
                <pre id="a3">openssl genpkey \
  -algorithm EC \
  -pkeyopt ec_paramgen_curve:P-384 \
  -out privada_ecdsa_p384.pem</pre>
                <button class="copy-btn" onclick="copyCmd('a3', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// RSA-4096 (compatibilidad)</div>
              <div class="cmd-wrap">
                <pre id="a4">openssl genpkey \
  -algorithm RSA \
  -pkeyopt rsa_keygen_bits:4096 \
  -aes-256-cbc \
  -out privada_rsa.pem</pre>
                <button class="copy-btn" onclick="copyCmd('a4', this)">copiar</button>
              </div>
            </div>

            <div class="note note-info">
              üí° Ed25519 se usa para firmas. Para cifrado moderno se suele usar un esquema h√≠brido (intercambio de clave + AES-GCM / ChaCha20-Poly1305).
            </div>
          </div>
        </div>

        <!-- OpenSSL Firma y Certificados -->
        <div class="tool-card">
          <div class="card-header">
            <div>
              <div class="tool-name">OpenSSL ‚Äî Firma &amp; Certs</div>
              <h3>Firma digital y X.509</h3>
            </div>
            <span class="badge badge-rec">‚úì Recomendado</span>
          </div>
          <div class="card-body">
            <div class="cmd-block">
              <div class="label">// Firmar archivo (con Ed25519)</div>
              <div class="cmd-wrap">
                <pre id="a5">openssl pkeyutl -sign \
  -inkey privada_ed25519.pem \
  -in archivo.txt \
  -out firma.sig</pre>
                <button class="copy-btn" onclick="copyCmd('a5', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Verificar firma</div>
              <div class="cmd-wrap">
                <pre id="a6">openssl pkeyutl -verify \
  -pubin -inkey publica_ed25519.pem \
  -in archivo.txt \
  -sigfile firma.sig</pre>
                <button class="copy-btn" onclick="copyCmd('a6', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Certificado autofirmado ‚Äî ECDSA P-384</div>
              <div class="cmd-wrap">
                <pre id="a7">openssl req -x509 \
  -newkey ec \
  -pkeyopt ec_paramgen_curve:P-384 \
  -keyout privada.key \
  -out cert.crt \
  -days 365 \
  -sha256</pre>
                <button class="copy-btn" onclick="copyCmd('a7', this)">copiar</button>
              </div>
            </div>

            <div class="note note-warn">
              ‚ö†Ô∏è Si a√±ades <code style="background:none;color:inherit">-nodes</code>, la clave privada quedar√° sin cifrar. √ösalo solo si entiendes el riesgo (p. ej., entornos controlados).
            </div>
            <div class="note note-info">
              üí° En TLS moderno se recomienda validez corta (p. ej. ~90‚Äì397 d√≠as) y rotaci√≥n frecuente.
            </div>
          </div>
        </div>

        <!-- GPG Asim√©trico -->
        <div class="tool-card">
          <div class="card-header">
            <div>
              <div class="tool-name">GPG ‚Äî Claves</div>
              <h3>Generaci√≥n y gesti√≥n</h3>
            </div>
            <span class="badge badge-rec">‚úì Recomendado</span>
          </div>
          <div class="card-body">
            <div class="cmd-block">
              <div class="label">// Generar par de claves (recomendado en GPG moderno)</div>
              <div class="cmd-wrap">
                <pre id="a8">gpg --full-generate-key
# Elige ECC (si aparece: ‚ÄúECC and ECC‚Äù o ‚ÄúCurve25519‚Äù)</pre>
                <button class="copy-btn" onclick="copyCmd('a8', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Listar claves</div>
              <div class="cmd-wrap">
                <pre id="a9">gpg --list-keys
gpg --list-secret-keys</pre>
                <button class="copy-btn" onclick="copyCmd('a9', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Exportar clave p√∫blica</div>
              <div class="cmd-wrap">
                <pre id="a10">gpg --armor --export TU_KEYID \
  -o publica.asc</pre>
                <button class="copy-btn" onclick="copyCmd('a10', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Backup clave privada (guardar MUY seguro)</div>
              <div class="cmd-wrap">
                <pre id="a11">gpg --armor --export-secret-key \
  TU_KEYID -o privada_backup.asc</pre>
                <button class="copy-btn" onclick="copyCmd('a11', this)">copiar</button>
              </div>
            </div>

            <div class="note note-danger">
              üö® El backup de clave privada te permite ‚Äúser t√∫‚Äù: gu√°rdalo cifrado, offline y con copias controladas.
            </div>
          </div>
        </div>

        <!-- GPG Cifrado y Firma -->
        <div class="tool-card">
          <div class="card-header">
            <div>
              <div class="tool-name">GPG ‚Äî Operaciones</div>
              <h3>Cifrar / Firmar</h3>
            </div>
            <span class="badge badge-rec">‚úì Recomendado</span>
          </div>
          <div class="card-body">
            <div class="cmd-block">
              <div class="label">// Cifrar para destinatario</div>
              <div class="cmd-wrap">
                <pre id="a12">gpg -e -a \
  -r "destinatario@email.com" \
  archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('a12', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Descifrar</div>
              <div class="cmd-wrap">
                <pre id="a13">gpg -d archivo.txt.asc &gt; archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('a13', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Firmar archivo (firma separada)</div>
              <div class="cmd-wrap">
                <pre id="a14">gpg --detach-sign --armor archivo.txt
# Genera: archivo.txt.asc</pre>
                <button class="copy-btn" onclick="copyCmd('a14', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Verificar firma</div>
              <div class="cmd-wrap">
                <pre id="a15">gpg --verify archivo.txt.asc archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('a15', this)">copiar</button>
              </div>
            </div>

            <div class="cmd-block">
              <div class="label">// Cifrar + firmar</div>
              <div class="cmd-wrap">
                <pre id="a16">gpg -s -e -a \
  -r "destinatario@email.com" \
  archivo.txt</pre>
                <button class="copy-btn" onclick="copyCmd('a16', this)">copiar</button>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- ============================= -->
    <!-- TABLA COMPARATIVA -->
    <!-- ============================= -->
    <div class="compare-section">
      <h3 class="compare-title">GPG vs OpenSSL</h3>
      <table>
        <thead>
          <tr>
            <th>Caracter√≠stica</th>
            <th>GPG</th>
            <th>OpenSSL</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Cifrado sim√©trico</td>
            <td>AES-256, Camellia-256</td>
            <td>AES-256-GCM, ChaCha20-Poly1305</td>
          </tr>
          <tr>
            <td>Claves asim√©tricas</td>
            <td>Ed25519, Curve25519, RSA</td>
            <td>Ed25519, ECDSA P-384, RSA-4096</td>
          </tr>
          <tr>
            <td>Hash directo</td>
            <td>‚âà No es su foco (orientado a OpenPGP)</td>
            <td><span class="tick">‚úì</span> SHA-256, SHA-512, SHA3-256</td>
          </tr>
          <tr>
            <td>Certificados X.509</td>
            <td><span class="cross">‚úó</span> OpenPGP (web of trust)</td>
            <td><span class="tick">‚úì</span> Soporte completo</td>
          </tr>
          <tr>
            <td>Firma digital</td>
            <td><span class="tick">‚úì</span> Firmas OpenPGP</td>
            <td><span class="tick">‚úì</span> + certificados TLS</td>
          </tr>
          <tr>
            <td>Uso principal</td>
            <td>Correo, archivos, backups</td>
            <td>Servidores, PKI, TLS/HTTPS</td>
          </tr>
          <tr>
            <td>GUI disponible</td>
            <td><span class="tick">‚úì</span> Kleopatra, Thunderbird</td>
            <td>Solo CLI (GUIs externas)</td>
          </tr>
        </tbody>
      </table>

      <!-- Mini glosario -->
      <div class="tool-card" style="margin-top:20px;">
        <div class="card-header">
          <div>
            <div class="tool-name">Mini glosario</div>
            <h3>Conexi√≥n r√°pida con los conceptos</h3>
          </div>
          <span class="badge badge-warn">‚òÖ Did√°ctico</span>
        </div>
        <div class="card-body">
          <div class="note note-info" style="margin-top:0;">
            üß© <b>Confidencialidad</b> ‚Üí cifrado (AES-GCM / ChaCha20-Poly1305)
          </div>
          <div class="note note-info">
            üß© <b>Integridad</b> ‚Üí hash / AEAD / firma (mejor: AEAD o firma)
          </div>
          <div class="note note-info">
            üß© <b>Autenticaci√≥n</b> ‚Üí firma digital / certificados
          </div>
          <div class="note note-info">
            üß© <b>No repudio</b> ‚Üí firma digital + gesti√≥n de claves/PKI
          </div>
        </div>
      </div>

    </div>

  </div>

  <script>
    // Tabs
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.tab).classList.add('active');
      });
    });

    // Copy with fallback
    async function copyCmd(id, btn) {
      const text = document.getElementById(id).innerText;

      try {
        if (navigator.clipboard && window.isSecureContext) {
          await navigator.clipboard.writeText(text);
        } else {
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          document.execCommand('copy');
          ta.remove();
        }

        btn.textContent = '‚úì copiado';
        btn.classList.add('copied');
        setTimeout(() => {
          btn.textContent = 'copiar';
          btn.classList.remove('copied');
        }, 2000);

      } catch (e) {
        btn.textContent = 'error';
        setTimeout(() => { btn.textContent = 'copiar'; }, 2000);
      }
    }
  </script>
</body>
</html>
